/**
 * ngScreening v0.1.4
 *
 * @license: MIT
 * Designed and built by Moer
 * github   https://github.com/Moerj/ngScreening
 *
 */
!function(e){function n(n){return{restrict:"AE",scope:{data:"=",multiName:"@"},require:"^ngScreening",template:'<input type="button" class="screening-item btn"ng-class="{\'screening-item-checked\':mulitiActive}" /> | <input type="button"ng-repeat="item in data"ng-class="{\'screening-item-checked\':item.isChecked}"ng-click="checkItem()"ng-if="!item.isHidden"ng-value="item.name"class="screening-item btn"index="{{$index}}">',controller:["$scope",function(i){i.mulitiActive=!1,i.checkItem=function(){return this.item.isChecked=!this.item.isChecked,n||e.forEach(i.data,function(e){e!=this.item&&(e.isChecked=!1)}.bind(this)),this.pCtrl.callback(),!1},i.mulitiToggle=function(){i.mulitiActive=!i.mulitiActive,e.forEach(this.data,function(e){e.isChecked=i.mulitiActive}),this.pCtrl.callback()}}],link:function(e,i,c,t){e.pCtrl=t;var r=i.children().eq(0);n?(e.multiName?r.val(e.multiName):r.val("全选"),e.mulitiActive=!1,r.on("click",function(){return e.mulitiToggle(),e.$apply(),!1})):e.multiName?r.val(e.multiName):r.val("单选")}}}var i=e.module("ngScreening",[]);i.service("ngScreening",function(){return{getChecked:function(n){var i=[];return e.forEach(n,function(e){e.isChecked&&!e.isHidden&&i.push(e)}),i},resize:function(n){if(n)n._screening_resize();else{var i=document.getElementsByClassName("screening");e.forEach(i,function(e){e._screening_resize&&e._screening_resize()})}}}}),i.directive("ngScreening",function(){return{restrict:"E",scope:{callback:"&",initrows:"@"},replace:!0,transclude:!0,template:'<div class="ngScreening"><div class="ngScreening-container" ng-transclude></div><div class="ngScreening-switch"><b><</b><i class="ngScreening-hide">></i></div></div>',controller:["$scope",function(e){this.callback=function(){return e.callback()}}],link:function(n,i){var c=n.initrows,t=e.element(i[0].querySelector(".ngScreening-container")),r=t.next();if(!c||0>c)return void r.remove();var s=r.find("b"),l=r.find("i"),g=t.children(),a=c>0&&c<g.length;a&&setTimeout(function(){s.toggleClass("ngScreening-hide"),l.toggleClass("ngScreening-hide");for(var n=c;n<g.length;n++)e.element(g[n]).addClass("ngScreening-hide")},200),r.on("click",function(){return a?(a=!1,s.toggleClass("ngScreening-hide"),l.toggleClass("ngScreening-hide"),t.children().removeClass("ngScreening-hide")):(t.toggleClass("ngScreening-hide"),s.toggleClass("ngScreening-hide"),l.toggleClass("ngScreening-hide")),!1})}}}),i.directive("screening",["ngScreening",function(n){return{restrict:"AE",scope:{label:"@",initrows:"@"},replace:!0,transclude:!0,require:"^ngScreening",template:'<div class="screening"><div class="screening-name">{{label}}</div><div class="screening-container" ng-transclude></div><div class="screening-switch ngScreening-hide"><b class="ngScreening-hide"><</b><i>></i></div></div>',link:function(i,c){var t=i.initrows;if(t&&!(0>=t)){var r=!1,s=e.element(c[0].querySelector(".screening-switch")),l=s.find("b"),g=s.find("i"),a=c[0].offsetHeight;s.on("click",function(){return r?c.css({height:a*t+"px",overflow:"hidden"}):c.css({height:"",overflow:""}),l.toggleClass("ngScreening-hide"),g.toggleClass("ngScreening-hide"),r=!r,!1});var o=e.element(c[0].querySelector(".screening-container"));i.$watch(function(){return o[0].offsetHeight},function(){n.resize(c[0])}),c[0]._screening_resize=function(){o[0].offsetHeight>=a*t?(s.removeClass("ngScreening-hide"),c.css({height:a*t+"px",overflow:"hidden"}),r&&c.css({height:"",overflow:""})):(s.addClass("ngScreening-hide"),c.css({height:"",overflow:""}))}}}}}]),i.directive("screeningDiv",function(){return{restrict:"E",scope:{width:"@",label:"@"},transclude:!0,template:'<span style="margin:0 10px 0 10px">{{label}}</span><div class="screening-div" style="width:{{width}}" ng-transclude></div>'}}),i.directive("screeningCheckbox",function(){return n(!0)}),i.directive("screeningRadio",function(){return n()}),i.directive("screeningWatch",function(){return{restrict:"E",scope:{watch:"="},require:"^ngScreening",link:function(e,n,i,c){n.remove(),e.$watch("watch",function(e,n){n!=e&&e&&c.callback()})}}}),i.directive("screeningEvent",function(){return{restrict:"A",scope:{screeningEvent:"@"},require:"^ngScreening",replace:!0,link:function(e,n,i,c){var t="change";e.screeningEvent&&(t=e.screeningEvent),n.on(t,function(){return c.callback(),!1})}}})}(angular);