/**
 * ngScreening v0.2.3
 *
 * @license: MIT
 * Designed and built by Moer
 * github   https://github.com/Moerj/ngScreening
 *
 */
!function(e){function n(n){return{restrict:"AE",scope:{data:"=",multiName:"@"},require:"^ngScreening",template:'<input type="button" class="screening-item btn"ng-class="{\'screening-item-checked\':mulitiActive}" /> | <input type="button"ng-repeat="item in data"ng-class="{\'screening-item-checked\':item.isChecked}"ng-click="checkItem()"ng-if="!item.isHidden"ng-value="item.name"class="screening-item btn"index="{{$index}}">',controller:["$scope",function(i){i.mulitiActive=!1,i.checkItem=function(){return this.item.isChecked=!this.item.isChecked,n||e.forEach(i.data,function(e){e!=this.item&&(e.isChecked=!1)}.bind(this)),this.pCtrl.callback(),!1},i.mulitiToggle=function(){i.mulitiActive=!i.mulitiActive,e.forEach(this.data,function(e){e.isChecked=i.mulitiActive}),this.pCtrl.callback()},i.$on("ngScreening-reset",function(){i.mulitiActive=!1,e.forEach(i.data,function(e){e.isChecked&&(e.isChecked=!1)})})}],link:function(e,i,t,c){e.pCtrl=c;var r=i.children().eq(0);n?(e.multiName?r.val(e.multiName):r.val("全选"),e.mulitiActive=!1,r.on("click",function(){return e.mulitiToggle(),e.$apply(),!1})):e.multiName?r.val(e.multiName):r.val("单选")}}}var i=e.module("ngScreening",[]);i.service("ngScreening",function(){return{getChecked:function(n){var i=[];return e.forEach(n,function(e){e.isChecked&&!e.isHidden&&i.push(e)}),i},resize:function(n){if(n)n._screening_resize();else{var i=document.getElementsByClassName("screening");e.forEach(i,function(e){e._screening_resize&&e._screening_resize()})}}}}),i.directive("ngScreening",function(){return{restrict:"EC",scope:{initrows:"@",callback:"&",search:"&",reset:"&"},replace:!0,transclude:!0,template:'<div class="ngScreening-start"><form class="ngScreening-container" ng-transclude></form><div class="ngScreening-switch"><b></b><i class="ngScreening-hide"></i></div></div>',controller:["$scope",function(e){this.callback=function(){return e.callback()}}],link:function(n,i){function t(){i.removeClass("ngScreening")}var c,r=e.element(i[0].querySelector(".ngScreening-container")),s=r.next(),l=s.find("b"),a=s.find("i"),o=n.search,g=n.reset,d=n.initrows,u=r.children(),f=d>0&&d<u.length;if(i.attr("search")||void 0!==i.attr("reset")){if(c=e.element('<div class="screening screening-buttons"></div>'),r.append(c),i.attr("search")){var h=e.element('<button type="button" class="btn btn-primary btn-sm">搜索</button>');h.on("click",function(e){e.stopPropagation(),o(),n.$apply()}),c.append(h)}if(void 0!==i.attr("reset")){var v=e.element('<button type="button" class="btn btn-default btn-sm">重置</button>');v.on("click",function(e){e.stopPropagation(),n.$broadcast("ngScreening-reset"),r[0].reset(),g(),n.$apply()}),c.append(v)}}f?setTimeout(function(){l.toggleClass("ngScreening-hide"),a.toggleClass("ngScreening-hide");for(var n=d;n<u.length;n++)e.element(u[n]).addClass("ngScreening-hide");c&&c.removeClass("ngScreening-hide"),t()},300):setTimeout(function(){t()},300),s.on("click",function(){return f?(f=!1,l.toggleClass("ngScreening-hide"),a.toggleClass("ngScreening-hide"),r.children().removeClass("ngScreening-hide")):(r.toggleClass("ngScreening-hide"),l.toggleClass("ngScreening-hide"),a.toggleClass("ngScreening-hide")),!1})}}}),i.directive("screening",function(){return{restrict:"AE",scope:{label:"@",initrows:"@"},replace:!0,transclude:!0,require:"^ngScreening",template:'<div class="screening"><div class="screening-name" ng-hide="flexOnly">{{label}}</div><div class="screening-container" ng-transclude></div><div class="screening-switch ngScreening-hide"><b class="ngScreening-hide"></b><i></i></div></div>',controller:["$scope","$element",function(e,n){e.initHeight=n[0].clientHeight}],link:function(n,i){function t(){r[0].offsetHeight>u?(o.removeClass("ngScreening-hide"),i.css({height:u+"px",overflow:"hidden"}),a&&i.css({height:"",overflow:""})):(o.addClass("ngScreening-hide"),i.css({height:"",overflow:""}))}var c=n.initrows,r=e.element(i[0].querySelector(".screening-container")),s=r.children(),l=!0;if(e.forEach(s,function(n){var i=e.element(n);return i.hasClass("screening-flex")?void 0:(l=!1,!1)}),l?(n.flexOnly=l,i.css("padding-left","0")):e.forEach(r.children(),function(n){n=e.element(n),n.hasClass("screening-flex")&&setTimeout(function(){n.css("justify-content")||n.css("justify-content","center")})}),c&&!(0>=c)){var a=!1,o=e.element(i[0].querySelector(".screening-switch")),g=o.find("b"),d=o.find("i"),u=n.initHeight*c;o.on("click",function(){return a?i.css({height:u+"px",overflow:"hidden"}):i.css({height:"",overflow:""}),g.toggleClass("ngScreening-hide"),d.toggleClass("ngScreening-hide"),a=!a,!1}),i[0]._screening_resize=t;var f=n.$watch(function(){return r[0].offsetHeight},function(e,n){e!=n&&(f(),t(i[0]))}),h=!1;e.element(window).on("resize",function(){h||(h=!0,t(i[0]),setTimeout(function(){h=!1},500))})}}}}),i.directive("screeningWatch",function(){return{restrict:"E",scope:{data:"="},require:"^ngScreening",link:function(n,i,t,c){i.remove(),n.$watch("data",function(e,n){n!=e&&e&&c.callback()}),n.$on("ngScreening-reset",function(){e.isString(n.data)?n.data="":e.isArray(n.data)?n.data=[]:n.data=null})}}}),i.directive("screeningEvent",function(){return{restrict:"A",scope:{screeningEvent:"@"},require:"^ngScreening",replace:!0,link:function(e,n,i,t){var c="change";e.screeningEvent&&(c=e.screeningEvent),n.on(c,function(){return t.callback(),!1})}}}),i.directive("screeningCheckbox",function(){return n(!0)}),i.directive("screeningRadio",function(){return n()}),i.directive("screeningDiv",function(){return{restrict:"E",scope:{width:"@",label:"@"},transclude:!0,replace:!0,template:'<div><span style="margin:0 10px 0 10px" ng-if="label">{{label}}</span><div class="screening-div" style="width:{{width}}" ng-transclude></div></div>'}}),i.directive("screeningFlex",function(){return{restrict:"E",scope:{width:"@",label:"@",justifyContent:"@"},transclude:!0,replace:!0,template:'<div class="screening-flex" style="justify-content:{{justifyContent}}"><span class="screening-name" style="position:relative" ng-if="label">{{label}}</span><div style="width:{{width}};" ng-transclude></div></div>'}})}(angular);